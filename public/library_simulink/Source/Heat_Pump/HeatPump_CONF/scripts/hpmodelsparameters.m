% hot side thermal capacity
% $Revision$
% $Author$
% $Date$
% $HeadURL$
Ch = [25e3 28e3 32e3 36e3 40e3];
caph = Ch(hptype); 

% cold side thermal capacity
Cc = [16e3 17e3 18e3 19e3 20e3];
capc = Ch(hptype); 

% pressure drop data sheet values: 
% dp = [7 20 30 30 35 60]*1e2
% mdot = [530 720 880 1040 1300 1510]/3600
P =[16.1480954076184e+003    2.37735849056604e+003;
    25.0000000000000e+003    5.00000000000000e+003; ...
    25.1033057851240e+003    6.13636363636363e+003; ...
    17.9733727810651e+003    5.19230769230769e+003; ...
    13.4201183431953e+003    4.84615384615384e+003];
dp(1) = P(hptype,2);
dp(2) = P(hptype,1);

% thermal losses
UAbw = [5 5.5 6 6.5 7];
UA = UAbw(hptype);

% power matrix from data sheet
% BW106: Qdoth = [5940 5460; 8670 7910];  Qdotc = [4710 3410; 7500 5990];
% BW106: Pel = [1320 2210; 1270 2070]; Thout = [35 55]; Tcin = [0 15]; 
% BW108: Qdoth = [7850 7100; 11500 10300]; Qdotc = [6300 4600; 9950 7850];
% BW108: Pel = [1720 2690; 1670 2600]; Thout = [35 55]; Tcin = [0 15];
% BW110: Qdoth = [10000 9100; 14800 13300];Qdotc = [8050 6050; 12950 10350];
% BW110: Pel = [2100 3300; 2000 3200]; Thout = [35 55]; Tcin = [0 15];
% BW113: Qdoth = [13150 12250; 19150 17450];Qdotc = [10500 8000; 16600 13300];
% BW113: Pel = [2800 4550; 2700 4400]; Thout = [35 55]; Tcin = [0 15];
% BW 117: Qdoth = [14300 13800 13000 12200; 24100 23200 22300 21500];
% BW 117: Qdotc = [11000 9800 8400 6200; 20400 18900 17000 15100];
% BW 117: Pel = [3800 4300 5100 6100; 4200 5100 6000 7000];
% BW 117: Thout = [35 45 55 65]; Tcin = [-5 15];

% Matrix construction for hp_param
% A = reshape(Qdoth',numel(Qdoth),1); A = [A reshape(Qdotc',numel(Qdotc),1)];
% A = [A reshape(Pel',numel(Pel),1)]; Thout_temp = []; Tcin_temp = [];
% for i=1:numel(Tcin)
%     for j=1:numel(Thout)
%         Tcin_temp = [Tcin_temp ; Tcin(i)];
%     end
%     Thout_temp = [Thout_temp ; Thout'];
% end
% A = [A Tcin_temp Thout_temp];
% K = hp_param(A);

Kbw = [ ... % BW 106
    172.666667120004  -31.0000006102120  7095.00002905086 ...
    -6.33333383294697  42.2499995181333 -136.249984347629 ...
    178.999999113974  -70.2500000918737  7221.25000248006 ...
    ; ... % BW 108
    228.333332828320  -48.7500011825295  9668.75005285725 ...
    -4.66666588500265  47.4999997950100  67.4999963209812 ...
    230.000000657876  -95.0000000060525  9725.00000277819 ...
    ; % BW 110
    299.999998982327  -59.9999988176087  12249.9999711932 ...
    -6.66666603880034  60.0000010482174 -51.3158332307255e-006 ...
    306.666667839537  -115.000000230844  12225.0000010917 ...
    ; ... % BW 113
    373.333333721478  -64.9999997761544  15624.9999991921 ...
    -8.33333390057269  86.2499987677053 -206.249943079605 ...
    379.999999564417  -144.999999722449  15774.9999836109 ...
    ; ... % BW 117
    472.500000146257  -79.0000006092512  19637.5000290341 ...
    37.5000013897344   84.9999991759346  762.500037115817 ...
    449.999999654666  -167.999999731486  19500.0000018284 ];
K = Kbw(hptype,:);